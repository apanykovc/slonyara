# slonyara

Набор утилит для парсинга строк ролей и проверки прав доступа. Репозиторий содержит
минимальный сервисный слой, unit-тесты и инфраструктуру для автоматического запуска
проверок.

## Требования

* Python 3.10+
* `pip` и `venv`

## Быстрый старт

```bash
python -m venv .venv
source .venv/bin/activate  # Windows: .venv\\Scripts\\activate
pip install -e .[dev]
```

После установки доступны команды:

* `pytest` — запуск модульных тестов.
* `ruff check` — статический анализатор.
* `ruff format` — автоформатирование кода.

## Конфигурация сервисов

Функции `parse_roles` и `check_roles` предоставляют параметры для настройки поведения
без необходимости правок кода:

* `parse_roles(..., separator=";", unique=False, sort=True)` — позволяет выбрать
  разделитель, отключить фильтрацию дубликатов и вернуть отсортированный список.
* `parse_roles(..., normalizer=None)` — отключает приведение к нижнему регистру.
* `check_roles(..., mode="all")` — требует наличия всех ролей (по умолчанию достаточно
  совпадения любой роли).
* `check_roles(..., case_sensitive=True)` — включает чувствительность к регистру.
* `check_roles(..., normalizer=lambda value: value.split(":")[-1])` — даёт возможность
  реализовать собственную нормализацию значений.

## Запуск тестов и линтеров локально

```bash
pytest
ruff check
```

Для интеграции в рабочий процесс можно создать pre-commit hook или запускать команды
через CI. Репозиторий уже содержит workflow GitHub Actions, который выполняет оба шага
при каждом push.

## Структура проекта

```
├── pyproject.toml      # настройки зависимостей, pytest и ruff
├── src/slonyara/       # сервисные функции
└── tests/              # модульные тесты
```

## CI/CD

Workflow `.github/workflows/ci.yml` запускает проверки на GitHub Actions для Python 3.11.
При необходимости можно расширить матрицу версий или добавить дополнительные команды.
